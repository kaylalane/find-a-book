import{d as p,j as s,r as c,c as d,e as m,f as j,g as u,L as x}from"./index-4qHAoL08.js";const h=()=>p();function v({review:a}){return s.jsxs("div",{className:"review-card",children:[s.jsx("p",{className:"review-card__author",children:a.userName}),s.jsx("p",{children:a.review})]})}function g(){const[a,e]=c.useState([]),n=d();return c.useEffect(()=>{const r=`/api/reviews/${n.id}`;(async()=>{fetch(`${r}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then(async i=>{const t=await i.json();e(t)})})()},[n]),s.jsxs("div",{children:[s.jsx("h2",{children:"Reviews"}),s.jsx("div",{children:a.map(r=>s.jsx(v,{review:r}))})]})}function w({book:a}){const[e,n]=c.useState(-1),{user:r}=h(),o=async()=>{const i=await u((r==null?void 0:r.id)||"");try{const l=await(await fetch(`/api/review/${a._id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({overall_rating:e,bookId:a._id,authorId:a.authorId,authorName:a.authorName,userId:i})})).json();console.log(l)}catch(t){console.log(t)}};return s.jsx("div",{className:" my-1 book-page__stars",children:[...new Array(5)].map((i,t)=>s.jsx(m,{className:j("btn star ",t<=e&&"star--selected"),intent:"text",onClick:()=>{n(t),o()},children:s.jsxs("span",{className:"sr-only",children:[t+1," out of 5 stars"]})},t))})}function _(){const{user:a}=h(),[e,n]=c.useState(),r=d();return c.useEffect(()=>{(async()=>{const i=`/api/books/${r.id}`;fetch(i,{method:"GET",headers:{"Content-Type":"application/json"}}).then(async t=>{const l=await t.json();n(l)})})()},[r]),s.jsx(x,{className:"no-scroll",children:s.jsxs("div",{className:"book-page",children:[s.jsx("div",{className:"book-page__cover-container",children:s.jsx("img",{src:(e==null?void 0:e.cover)||"",alt:`${e==null?void 0:e.title} cover`,className:"book-page__cover"})}),s.jsxs("div",{className:"book-page__information",children:[s.jsx("h1",{className:"book-page__title",children:e==null?void 0:e.title}),s.jsxs("p",{className:"book-page__author",children:["by"," ",s.jsx("a",{href:`/author/${e==null?void 0:e.authorId}`,children:e==null?void 0:e.authorName})]}),e!=null&&e.description?s.jsx("p",{children:e.description}):s.jsx("p",{children:"There's no book description"}),s.jsx("h2",{className:"heading",children:"Ratings & Reviews"}),s.jsxs("div",{className:"book-page__review",children:[s.jsx("p",{children:"What do you think?"}),s.jsx("img",{src:a==null?void 0:a.imageUrl,className:"user-image"}),e&&s.jsx(w,{book:e}),s.jsx("a",{href:`/review/${(e==null?void 0:e._id)||""}`,className:"btn btn-primary",children:"Create a Review"})]}),s.jsx(g,{})]})]})})}export{_ as default};
