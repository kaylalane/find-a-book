import{r as l,j as e,B as c,h as v,i as x,c as j,d as p,e as w,g}from"./index-KDzMasfK.js";import{u as N}from"./useClerk-7TgjYqNx.js";const f={review:"Write your review. (Optional)",overallRating:null};function y({book:r}){const{user:a}=N(),[n,d]=l.useState(f),[o,m]=l.useState(-1),h=async t=>{t.preventDefault();try{const s=await x((a==null?void 0:a.id)||""),u=await(await fetch(`/api/review/${r._id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({review:n.review,overall_rating:o,bookId:r._id,authorId:r.authorId,authorName:r.authorName,userId:s})})).json();console.log(u)}catch(s){console.log(s)}};return e.jsxs("div",{children:[e.jsx("div",{className:" my-1",children:[...new Array(5)].map((t,s)=>e.jsx(c,{className:v("btn star ",s<=o&&"star--selected"),intent:"text",onClick:()=>m(s),children:e.jsxs("span",{className:"sr-only",children:[s+1," out of 5 stars"]})},s))}),e.jsx("div",{className:"separator separator--margin"}),e.jsxs("form",{action:"",className:"review-form",children:[e.jsxs("label",{className:"review-form-label",children:[e.jsx("p",{className:" my-2",children:"What did you think?"}),e.jsx("textarea",{name:"",id:"",className:"review-input",value:n.review,onChange:t=>d({...n,review:t.target.value})})]}),e.jsx(c,{intent:"secondary",onClick:t=>h(t),children:"Post"})]})," "]})}function b(){const r=j(),i=p({queryKey:["book",r.id||""],queryFn:w});if(i.isLoading)return e.jsx(g,{});const a=i.data;return e.jsxs("div",{className:"review-page",children:[e.jsxs("h1",{className:"page-title",children:[e.jsx("a",{href:`/books/${a._id}`,className:" underline",children:a.title})," ","> Review"]}),e.jsxs("div",{className:"review-page-information",children:[e.jsx("img",{src:a.cover,alt:a.title,className:"book-cover--small"}),e.jsxs("div",{children:[e.jsx("a",{href:`/books/${a._id}`,className:" text-xl",children:a.title}),e.jsxs("p",{children:["by"," ",e.jsx("a",{href:`/author/${a.authorId}`,className:"author-name",children:a.authorName})]})]})]}),e.jsx("div",{className:"separator separator--margin"}),e.jsx(y,{book:a})]})}export{b as default};
